# 02. Ролевая модель и доступы (RBAC)

Система использует ролевую модель доступа (Role-Based Access Control).
**Публичная регистрация отключена.** Доступ к системе имеют только сотрудники (по приглашению) и Опекуны (через Telegram/Magic Link).

## 1. Матрица ролей (System Roles)

| Функционал / Модуль      | Опекун (Guardian) | Волонтер (Volunteer) | Ст. Волонтер (Senior) | Админ (Admin) |
| :----------------------- | :---------------: | :------------------: | :-------------------: | :-----------: |
| **Доступ**               |     Read-Only     |  Write (Restricted)  |     Write (Full)      |     Root      |
| **Животные**             |                   |                      |                       |               |
| Просмотр закрытых данных |     ✅ (Свои)     |          ✅          |          ✅           |      ✅       |
| Создание карточки        |        ❌         |          ❌          |          ✅           |      ✅       |
| Редактирование (свои)    |        ❌         |          ✅          |          ✅           |      ✅       |
| Редактирование (чужие)   |        ❌         |          ❌          |          ✅           |      ✅       |
| Смена статуса (Архив)    |        ❌         |          ❌          |          ✅           |      ✅       |
| **Финансы & Сборы**      |                   |                      |                       |               |
| Создание сбора           |        ❌         |          ❌          |          ✅           |      ✅       |
| Просмотр транзакций      |     ✅ (Свои)     |          ❌          |       ✅ (Все)        |   ✅ (Все)    |
| Выгрузка отчетов (PDF)   |        ❌         |          ❌          |          ✅           |      ✅       |
| **Команда (HR)**         |                   |                      |                       |               |
| Приглашение (Invite)     |        ❌         |          ❌          |          ❌           |      ✅       |
| Бан (Увольнение)         |        ❌         |          ❌          |      ✅ (Польз.)      |   ✅ (Всех)   |
| Смена роли               |        ❌         |          ❌          |          ❌           |      ✅       |
| **Заявки**               |                   |                      |                       |               |
| Обработка заявок         |        ❌         |      ✅ (Свои)       |          ✅           |      ✅       |

## 2. Детальное описание ролей

### 2.1. Administrator (Админ)

**Владелец системы / Директор.**

- Имеет доступ `root`.
- Единственный, кто может отправлять **Приглашения (Invites)** новым сотрудникам.
- Видит полную финансовую аналитику.
- Может разжаловать или уволить (забанить) любого сотрудника.
- _Защита:_ Системный "Root Admin" создается через переменные окружения и не может быть удален.

### 2.2. Senior Volunteer (Старший волонтер)

**Операционный менеджер.**

- Доверенное лицо. Может подменять админа в рутине управления животными.
- Может редактировать карточку любого животного (исправление ошибок).
- Отвечает за "Срочные сборы" и Новости.
- Модерирует "Черный список" клиентов.
- _Ограничение:_ Не может добавлять новых пользователей в систему.

### 2.3. Volunteer (Волонтер)

**Линейный сотрудник.**

- Работает "в поле".
- Может редактировать только тех животных, к которым привязан как "Куратор".
- Загружает фото, пишет текстовые отчеты.
- _Project Role:_ В профиле может быть указано "Водитель", "Фотограф", "Кинолог" (текстовое поле `position`), но системные права остаются на уровне Volunteer.

### 2.4. Guardian (Опекун)

**Клиент с подпиской.**

- Роль "только чтение".
- Авторизация через Telegram Login или Magic Link (по почте).
- Доступ к личному кабинету (или боту) для просмотра отчетов по своим подопечным.

## 3. Жизненный цикл сотрудника

### 3.1. Найм (Onboarding)

1.  Админ отправляет приглашение на Email.
2.  Сотрудник переходит по ссылке.
3.  Заполняет профиль: Имя, Telegram, Пароль.
4.  Аккаунт активируется.

### 3.2. Увольнение (Offboarding)

1.  Админ нажимает кнопку "Уволить" (Ban).
2.  Система **мгновенно** аннулирует все активные сессии сотрудника.
3.  Статус пользователя меняется на `BANNED`.
4.  Вход в систему блокируется.
5.  История действий (Logs) сохраняется.
